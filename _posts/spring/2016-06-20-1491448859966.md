---
layout:  post
title:  " 【SpringMVC学习04】Spring、MyBatis和SpringMVC的整合 "
date:    2016-06-20
excerpt: " 　　前两篇springmvc的文章中都没有和mybatis整合，都是使用静态数据来模拟的，但是springmvc开发不可能不整合mybatis，另外mybatis和spring的整合我之前学习mybatis的时候有写过一篇，但是仅仅是整合mybatis和spring，所以这篇文章我系统的总结一下spring、mybatis和springmvc三个框架的整合（后面学习到maven时，我会再写一篇使用maven整合的文章，这篇没有用到maven）。1.jar包管理　　我之前有写过一篇spring、hibernate和struts2整合的文章，在整合的时候，我个人不喜欢乱，不喜欢啪叽一下将所有jar包往lib中一扔，因为那样没有条理，所以在整合SSM的时候，我还是遵循jar包分类的原则，首先看一下SSM整合都用到了哪些jar包（点我下载）：　　这里我用的是dbcp，当然也可以用c3p0等其他连接池，归归类后jar包就很有条理。2.整合思路　　关于SSM的架构可以简单看一下下面的草图：　　可以看出，spring在进行管理时，是很有条理的，每个层都由spring管理，然后不同的层可以调用其它层，Handler调用service，service调用mapper等。根据这个架构，我们来总结一下整合的思路，根据这个调用关系，我们可以从下往上一步步整合。整合dao层。mybatis和spring整合，通过spring管理mapper接口。使用mapper的扫描器自动扫描mapper接口在spring中进行注册。整合service层。通过spring管理service接口。使用配置方式将service接口配置在spring配置文件中。实现事务控制。整合springmvc。由于springmvc是spring的模块，不需要整合。　　现在思路清晰了，接下来就开始整合了。在整合前先看一下我整合完的工程结构：3.整合dao层　　整合dao层也就是整合持久层，那么需要spring的核心包，持久层包，mybatis包，数据库以及连接池的包。所以将spring-persistence/spring-core/mysql-connector/mybatis/dbcp几个文件夹中的jar包拷贝到lib中。3.1mybatis全局配置文件　　首先得写mybatis的全局配置文件sqlMapConfig.xml，如下：<?xmlversion=1.0encoding=UTF-8?><!DOCTYPEconfigurationPUBLIC-//mybatis.org//DTDConfig3.0//ENhttp://mybatis.org/dtd/mybatis-3-config.dtd><configuration><!--setting配置根据需要再添加--><!--配置别名--><typeAliases><packagename=ssm.po/></typeAliases><!--mapper这里不需要配置了，因为跟spring整合后，在spring那边会进行mapper的扫描但必须遵循：mapper.xml和mapper.java必须同名且在一个目录--></configuration>　　可以看出，整合的时候，这个全局配置文件已经很清爽了，基本没啥东东了，因为数据源啊、mapper啊啥的都交给spring去管理了。关于db.properties和log4j.properties中的内容，我就不写了，可以参考我之前写的mybatis相关博文，也可以直接看我的源码。3.2配置spring配置文件　　配置完了mybatis的全局配置文件后，接下来就要配置spring的配置文件了，spring的配置文件我将分类写在不同的文件中，都放在config/spring/目录下了，这里是对dao的整合，所以起名applicationContext-dao.xml。<?xmlversion=1.0encoding=UTF-8?><beansxmlns=http://www.springframework.org/schema/beansxmlns:xsi=http://www.w3.org/2001/XMLSchema-instancexmlns:mvc=http://www.springframework.org/schema/mvcxmlns:context=http://www.springframework.org/schema/contextxmlns:aop=http://www.springframework.org/schema/aopxmlns:tx=http://www.springframework.org/schema/txxsi:schemaLocation=http://www.springframework.org/schema/beanshttp://www.springframework.org/schema/beans/spring-beans-4.2.xsdhttp://www.springframework.org/schema/mvchttp://www.springframework.org/schema/mvc/spring-mvc-4.2.xsdhttp://www.springframework.org/schema/contexthttp://www.springframework.org/schema/context/spring-context.xsdhttp://www.springframework.org/schema/aophttp://www.springframework.org/schema/aop/spring-aop-4.2.xsdhttp://www.springframework.org/schema/txhttp://www.springframework.org/schema/tx/spring-tx.xsd><!--加载db.properties文件中的内容--><context:property-placeholderlocation=classpath:db.properties/><!--配置数据源dbcp--><beanid=dataSourceclass=org.apache.commons.dbcp.BasicDataSourcedestroy-method=close><propertyname=driverClassNamevalue=${jdbc.driver}/><propertyname=urlvalue=${jdbc.url}/><propertyname=usernamevalue=${jdbc.username}/><propertyname=passwordvalue=${jdbc.password}/><propertyname=maxActivevalue=10/><propertyname=maxIdlevalue=5/></bean><!--配置sqlSessionFactory--><beanid=sqlSessionFactoryclass=org.mybatis.spring.SqlSessionFactoryBean><propertyname=dataSourceref=dataSource/><propertyname=configLocationvalue=classpath:mybatis/sqlMapConfig.xml/></bean><!--配置mapper扫描器--><beanclass=org.mybatis.spring.mapper.MapperScannerConfigurer><!--扫描包的路径，如果需要扫描多个包，中间使用半角逗号隔开--><propertyname=basePackagevalue=ssm.mapper/><propertyname=sqlSessionFactoryBeanNamevalue=sqlSessionFactory></property></bean></beans>　　可以看出，整合dao层的时候主要配置一下数据源、sqlSessionFactory和mapper扫描器，这样的话，数据源，sqlSessionFactory和mapper在tomcat启动时就被spring实例化到了容器中。接下来就是准备po类及mapper了。3.3逆向工程生成po类及mapper　　关于如何使用mybatis的逆向工程我就不再赘述了，如果不太清楚的童鞋请看一下这篇文章：☞点我查看。将生成的代码拷贝到我们自己的工程中即可，如下（那些文件前的问号不管它，是我还没同步到github的缘故）：　　到这里dao层就整合好了，下面来做个测试，整合的时候一定要步步为营，别啪啪啪整合完了再一起测试，到时候出错再找就不太方便了。我们针对ItemsMapper接口中的SelectByPrimaryKey()方法做一个测试：publicclassItemsMapperTest{ApplicationContextapplicationContext=null;@BeforepublicvoidsetUp()throwsException{applicationContext=newClassPathXmlApplicationContext(classpath:spring/applicationContext-dao.xml);}@TestpublicvoidtestSelectByPrimaryKey(){ItemsMapperitemsMapper=(ItemsMapper)applicationContext.getBean(itemsMapper);Itemsitems=itemsMapper.selectByPrimaryKey(1);System.out.println(items);}}　　能打印出id为1的Items对象说明没有问题。3.4一个小插曲　　这里需要注意一个问题，刚刚逆向工程生成的代码，我们尽量不要去改动它，为什么呢？比如我现在改动了生成后的代码，后面万一需求改变，我肯定会根据新的表关系再生成一次，然后再拷到自己的工程，这样之前修改的东西就会被覆盖，如果又不想被覆盖，那就很麻烦了……要改的地方就太多了……所以我们永远不去修改生成之后的代码，如果有需要，我们在生成的代码基础上进行扩展（继承，组合等），这样就算代码重新生成，也不会影响我们的扩展类。　　我举个例子：假如现在有个需求：SELECT*FROMitemsWHEREitems.nameLIKE‘%参数%’　　这个参数我们要通过一个Items的包装类传进来，Items的包装类指的是，里面封装了Items的信息，还封装了其他信息。因为这个包装类除了查询Items相关信息外，还可能有关联查询，所以里面不仅仅就只有Items本身的信息。　　要实现这个需求，我们不能直接去改Items类，不能直接在Items类中添加东西，原因上面已经分析了，我们可以这么做：先写一个Items的继承类在这个继承类上进行扩展　　为啥要先写一个继承类呢？直接写Items的扩展类不就行了么？原因还是上面提到的，完以后面这个Items改了咋整？这是一点，还有就是Items的继承类里面，我就可以做一些新的操作了。看一下实现：//Items的继承类publicc... "
categories: spring 
comments: true
---
转自 (csdn): http://blog.csdn.net/eson_15/article/details/51700519
<div class="markdown_views">
 <p>　　<font size="3">前两篇springmvc的文章中都没有和mybatis整合，都是使用静态数据来模拟的，但是springmvc开发不可能不整合mybatis，另外mybatis和spring的整合我之前学习mybatis的时候有写过一篇，但是仅仅是整合mybatis和spring，所以这篇文章我系统的总结一下spring、mybatis和springmvc三个框架的整合（后面学习到maven时，我会再写一篇使用maven整合的文章，这篇没有用到maven）。</font></p> 
 <h2 id="1-jar包管理"><strong>1. jar包管理</strong></h2> 
 <p>　　<font size="3">我之前有写过一篇<a href="http://blog.csdn.net/eson_15/article/details/51277324">spring、hibernate和struts2整合</a>的文章，在整合的时候，我个人不喜欢乱，不喜欢啪叽一下将所有jar包往lib中一扔，因为那样没有条理，所以在整合SSM的时候，我还是遵循jar包分类的原则，首先看一下SSM整合都用到了哪些jar包（<a href="http://download.csdn.net/detail/eson_15/9552660">点我下载</a>）：  <img src="http://img.blog.csdn.net/20160617155429027" alt="jar包" title="">  　　<font size="3">这里我用的是dbcp，当然也可以用c3p0等其他连接池，归归类后jar包就很有条理。</font></font></p> 
 <h2 id="2-整合思路"><strong>2. 整合思路</strong></h2> 
 <p>　　<font size="3">关于SSM的架构可以简单看一下下面的草图：  <img src="http://img.blog.csdn.net/20160617155737898" alt="架构" title="">  　　<font size="3">可以看出，spring在进行管理时，是很有条理的，每个层都由spring管理，然后不同的层可以调用其它层，Handler调用service，service调用mapper等。根据这个架构，我们来总结一下整合的思路，根据这个调用关系，我们可以从下往上一步步整合。</font></font></p> 
 <blockquote> 
  <ol> 
   <li>整合dao层。mybatis和spring整合，通过spring管理mapper接口。  使用mapper的扫描器自动扫描mapper接口在spring中进行注册。</li> 
   <li>整合service层。通过spring管理 service接口。  使用配置方式将service接口配置在spring配置文件中。  实现事务控制。</li> 
   <li>整合springmvc。由于springmvc是spring的模块，不需要整合。</li> 
  </ol> 
 </blockquote> 
 <p>　　<font size="3">现在思路清晰了，接下来就开始整合了。在整合前先看一下我整合完的工程结构：  <img src="http://img.blog.csdn.net/20160618185506003" alt="工程结构" title=""></font></p> 
 <h2 id="3-整合dao层"><strong>3. 整合dao层</strong></h2> 
 <p>　　<font size="3">整合dao层也就是整合持久层，那么需要spring的核心包，持久层包，mybatis包，数据库以及连接池的包。所以将spring-persistence/spring-core/mysql-connector/mybatis/dbcp几个文件夹中的jar包拷贝到lib中。</font></p> 
 <h3 id="31-mybatis全局配置文件"><strong><font size="４">3.1 mybatis全局配置文件</font></strong></h3> 
 <p>　　<font size="3">首先得写mybatis的全局配置文件sqlMapConfig.xml，如下：</font></p> 
 <pre class="prettyprint"><code class="language-xml hljs "><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-doctype">&lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">configuration</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- setting配置根据需要再添加 --&gt;</span>
    <span class="hljs-comment">&lt;!-- 配置别名 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">typeAliases</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">package</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"ssm.po"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">typeAliases</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- mapper这里不需要配置了，因为跟spring整合后，在spring那边会进行mapper的扫描 但必须遵循：mapper.xml和mapper.java必须同名且在一个目录 --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">configuration</span>&gt;</span></code></pre> 
 <p>　　<font size="3">可以看出，整合的时候，这个全局配置文件已经很清爽了，基本没啥东东了，因为数据源啊、mapper啊啥的都交给spring去管理了。  关于db.properties和log4j.properties中的内容，我就不写了，可以参考我之前写的mybatis相关博文，也可以直接看我的源码。</font></p> 
 <h3 id="32-配置spring配置文件"><strong><font size="４">3.2 配置spring配置文件</font></strong></h3> 
 <p>　　<font size="3">配置完了mybatis的全局配置文件后，接下来就要配置spring的配置文件了，spring的配置文件我将分类写在不同的文件中，都放在config/spring/目录下了，这里是对dao的整合，所以起名applicationContext-dao.xml。</font></p> 
 <pre class="prettyprint"><code class="language-xml hljs "><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">beans</span> <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">"http://www.springframework.org/schema/beans"</span> <span class="hljs-attribute">xmlns:xsi</span>=<span class="hljs-value">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="hljs-attribute">xmlns:mvc</span>=<span class="hljs-value">"http://www.springframework.org/schema/mvc"</span> <span class="hljs-attribute">xmlns:context</span>=<span class="hljs-value">"http://www.springframework.org/schema/context"</span> <span class="hljs-attribute">xmlns:aop</span>=<span class="hljs-value">"http://www.springframework.org/schema/aop"</span> <span class="hljs-attribute">xmlns:tx</span>=<span class="hljs-value">"http://www.springframework.org/schema/tx"</span> <span class="hljs-attribute">xsi:schemaLocation</span>=<span class="hljs-value">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd"</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 加载db.properties文件中的内容 --&gt;</span>   
    <span class="hljs-tag">&lt;<span class="hljs-title">context:property-placeholder</span> <span class="hljs-attribute">location</span>=<span class="hljs-value">"classpath:db.properties"</span>/&gt;</span>

    <span class="hljs-comment">&lt;!-- 配置数据源dbcp --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">bean</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"dataSource"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"org.apache.commons.dbcp.BasicDataSource"</span> <span class="hljs-attribute">destroy-method</span>=<span class="hljs-value">"close"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"driverClassName"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"${jdbc.driver}"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"url"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"${jdbc.url}"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"username"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"${jdbc.username}"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"password"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"${jdbc.password}"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"maxActive"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"10"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"maxIdle"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"5"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">bean</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 配置sqlSessionFactory --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">bean</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"sqlSessionFactory"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"dataSource"</span> <span class="hljs-attribute">ref</span>=<span class="hljs-value">"dataSource"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"configLocation"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"classpath:mybatis/sqlMapConfig.xml"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">bean</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 配置mapper扫描器 --&gt;</span> 
    <span class="hljs-tag">&lt;<span class="hljs-title">bean</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- 扫描包的路径，如果需要扫描多个包，中间使用半角 逗号隔开--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"basePackage"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"ssm.mapper"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"sqlSessionFactoryBeanName"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"sqlSessionFactory"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">bean</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">beans</span>&gt;</span></code></pre> 
 <p>　　<font size="3">可以看出，整合dao层的时候主要配置一下数据源、sqlSessionFactory和mapper扫描器，这样的话，数据源，sqlSessionFactory和mapper在tomcat启动时就被spring实例化到了容器中。接下来就是准备po类及mapper了。</font></p> 
 <h3 id="33-逆向工程生成po类及mapper"><strong><font size="４">3.3 逆向工程生成po类及mapper</font></strong></h3> 
 <p>　　<font size="3">关于如何使用mybatis的逆向工程我就不再赘述了，如果不太清楚的童鞋请看一下这篇文章：☞<a href="http://blog.csdn.net/eson_15/article/details/51694684">点我查看</a>。  将生成的代码拷贝到我们自己的工程中即可，如下（那些文件前的问号不管它，是我还没同步到github的缘故）：  <img src="http://img.blog.csdn.net/20160618154325357" alt="po" title="">  　　<font size="3">到这里dao层就整合好了，下面来做个测试，整合的时候一定要步步为营，别啪啪啪整合完了再一起测试，到时候出错再找就不太方便了。我们针对ItemsMapper接口中的SelectByPrimaryKey()方法做一个测试：</font></font></p> 
 <pre class="prettyprint"><code class="language-java hljs "><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemsMapperTest</span> {</span>

    ApplicationContext applicationContext = <span class="hljs-keyword">null</span>;
    <span class="hljs-annotation">@Before</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUp</span>() <span class="hljs-keyword">throws</span> Exception {

        applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">"classpath:spring/applicationContext-dao.xml"</span>);
    }

    <span class="hljs-annotation">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSelectByPrimaryKey</span>() {
        ItemsMapper itemsMapper = (ItemsMapper) applicationContext.getBean(<span class="hljs-string">"itemsMapper"</span>);
        Items items = itemsMapper.selectByPrimaryKey(<span class="hljs-number">1</span>);
        System.out.println(items);
    }
}</code></pre> 
 <p>　　<font size="3">能打印出id为1的Items对象说明没有问题。</font></p> 
 <h3 id="34-一个小插曲"><strong><font size="４">3.4 一个小插曲</font></strong></h3> 
 <p>　　<font size="3">这里需要注意一个问题，刚刚逆向工程生成的代码，我们尽量不要去改动它，为什么呢？比如我现在改动了生成后的代码，后面万一需求改变，我肯定会根据新的表关系再生成一次，然后再拷到自己的工程，这样之前修改的东西就会被覆盖，如果又不想被覆盖，那就很麻烦了……要改的地方就太多了……所以我们永远不去修改生成之后的代码，如果有需要，我们在生成的代码基础上进行扩展（继承，组合等），这样就算代码重新生成，也不会影响我们的扩展类。  　　<font size="3">我举个例子：假如现在有个需求：</font></font></p> 
 <blockquote> 
  <p>SELECT * FROM items WHERE items.name LIKE ‘%参数%’</p> 
 </blockquote> 
 <p>　　<font size="3">这个参数我们要通过一个Items的包装类传进来，Items的包装类指的是，里面封装了Items的信息，还封装了其他信息。因为这个包装类除了查询Items相关信息外，还可能有关联查询，所以里面不仅仅就只有Items本身的信息。  　　<font size="3">要实现这个需求，我们不能直接去改Items类，不能直接在Items类中添加东西，原因上面已经分析了，我们可以这么做：</font></font></p> 
 <blockquote> 
  <ol> 
   <li>先写一个Items的继承类</li> 
   <li>在这个继承类上进行扩展</li> 
  </ol> 
 </blockquote> 
 <p>　　<font size="3">为啥要先写一个继承类呢？直接写Items的扩展类不就行了么？原因还是上面提到的，完以后面这个Items改了咋整？这是一点，还有就是Items的继承类里面，我就可以做一些新的操作了。看一下实现：</font></p> 
 <pre class="prettyprint"><code class="language-java hljs "><span class="hljs-comment">//Items的继承类</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemsCustom</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Items</span> {</span>

    <span class="hljs-comment">//可以添加商品信息的扩展属性，如果不添加，其实就是Items</span>

}</code></pre> 
 <pre class="prettyprint"><code class="language-java hljs "><span class="hljs-comment">//这个就是Items的包装类，我们从service开始，传递下去的都是包装类</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemsQueryVo</span> {</span>

    <span class="hljs-comment">//原始的商品信息</span>
    <span class="hljs-keyword">private</span> Items items;

    <span class="hljs-comment">//为了系统 可扩展性，对原始生成的po进行扩展</span>
    <span class="hljs-keyword">private</span> ItemsCustom itemsCustom;

    <span class="hljs-keyword">public</span> Items <span class="hljs-title">getItems</span>() {
        <span class="hljs-keyword">return</span> items;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setItems</span>(Items items) {
        <span class="hljs-keyword">this</span>.items = items;
    }

    <span class="hljs-keyword">public</span> ItemsCustom <span class="hljs-title">getItemsCustom</span>() {
        <span class="hljs-keyword">return</span> itemsCustom;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setItemsCustom</span>(ItemsCustom itemsCustom) {
        <span class="hljs-keyword">this</span>.itemsCustom = itemsCustom;
    }
}</code></pre> 
 <p>　　<font size="3">然后我们定义itemsMapperCustom.xml映射文件：</font></p> 
 <pre class="prettyprint"><code class="language-xml hljs "><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="hljs-doctype">&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" &gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">mapper</span> <span class="hljs-attribute">namespace</span>=<span class="hljs-value">"ssm.mapper.ItemsMapperCustom"</span> &gt;</span>
    <span class="hljs-comment">&lt;!-- 定义商品查询的sql片段，就是商品查询条件 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">sql</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"query_items_where"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- 使用动态sql，通过if判断，满足条件进行sql拼接 --&gt;</span>
        <span class="hljs-comment">&lt;!-- 查询条件通过ItemsQueryVo包装对象中的itemsCustom属性来传递--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">if</span> <span class="hljs-attribute">test</span>=<span class="hljs-value">"itemsCustom != null"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">if</span> <span class="hljs-attribute">test</span>=<span class="hljs-value">"itemsCustom.name != null and itemsCustom.name != ''"</span>&gt;</span>
                items.name LIKE '%${itemsCustom.name}%'
            <span class="hljs-tag">&lt;/<span class="hljs-title">if</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">if</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">sql</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">select</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"findItemsList"</span> <span class="hljs-attribute">parameterType</span>=<span class="hljs-value">"ssm.po.ItemsQueryVo"</span> <span class="hljs-attribute">resultType</span>=<span class="hljs-value">"ssm.po.ItemsCustom"</span>&gt;</span>
        SELECT items.* FROM items
        <span class="hljs-tag">&lt;<span class="hljs-title">where</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">include</span> <span class="hljs-attribute">refid</span>=<span class="hljs-value">"query_items_where"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">include</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">where</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">select</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">mapper</span>&gt;</span></code></pre> 
 <p>　　<font size="3">当然咯，对应的mapper接口要定义一下：</font></p> 
 <pre class="prettyprint"><code class="language-java hljs "><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ItemsMapperCustom</span> {</span>

    <span class="hljs-keyword">public</span> List&lt;ItemsCustom&gt; <span class="hljs-title">findItemsList</span>(ItemsQueryVo itemsQueryVo) <span class="hljs-keyword">throws</span> Exception;
}</code></pre> 
 <p>　　<font size="3">最后针对这个接口写一个测试类：</font></p> 
 <pre class="prettyprint"><code class="language-java hljs "><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemsMapperCustomTest</span> {</span>

    ApplicationContext applicationContext = <span class="hljs-keyword">null</span>;
    <span class="hljs-annotation">@Before</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUp</span>() <span class="hljs-keyword">throws</span> Exception {

        applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">"classpath:spring/applicationContext-dao.xml"</span>);
    }


    <span class="hljs-annotation">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindItemsList</span>() <span class="hljs-keyword">throws</span> Exception {
        ItemsMapperCustom itemsMapper = (ItemsMapperCustom) applicationContext.getBean(<span class="hljs-string">"itemsMapperCustom"</span>);

        ItemsQueryVo itemsQueryVo = <span class="hljs-keyword">new</span> ItemsQueryVo();
        ItemsCustom itemsCustom = <span class="hljs-keyword">new</span> ItemsCustom();
        itemsCustom.setName(<span class="hljs-string">"手机"</span>);
        itemsQueryVo.setItemsCustom(itemsCustom);


        List&lt;ItemsCustom&gt; itemsCustomList = itemsMapper.findItemsList(itemsQueryVo);
        System.out.println(itemsCustomList);
    }

}</code></pre> 
 <p>　　<font size="3">可以看到，我们操作的都是Items的继承类ItemsCustom和包装类ItemsQueryVo，这个ItemsQueryVo将贯穿整条线，从service调用，到dao层。由逆向工程生成的原始的po类我们不去操作它们，除非是简单的查询，那么直接查即可。</font></p> 
 <h2 id="3-整合service层"><strong>3. 整合service层</strong></h2> 
 <p>　　<font size="3">先把jar包导了再说，整合service层需要配置事务了，所以要导入spring-aop中所有的jar包到lib中。  　　<font size="3">之前提到过，service是用来调用mapper的，mapper是用来操作数据库的，其实上面的小插曲中的测试代码就有点类似service层做的事，先获取mapper接口的代理对象，然后操作数据库。所以在service层，我们首先要获取mapper接口的代理对象，只不过在这里我们通过spring注入进来，然后通过这个代理对象去操作数据库。下面看一下整个整合的步骤：</font></font></p> 
 <h3 id="31-先写service接口"><strong><font size="４">3.1 先写service接口</font></strong></h3> 
 <pre class="prettyprint"><code class="language-java hljs "><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ItemsService</span> {</span>

    <span class="hljs-keyword">public</span> List&lt;ItemsCustom&gt; <span class="hljs-title">findItemsList</span>(ItemsQueryVo itemsQueryVo) <span class="hljs-keyword">throws</span> Exception;

}</code></pre> 
 <p>　　<font size="3">可以看出，这个接口和上面那个mapper接口其实是一样的，当然并不是说一定一样，只不过这里要实现的逻辑都一样而已。</font></p> 
 <h3 id="32-service实现类"><strong><font size="４">3.2 service实现类</font></strong></h3> 
 <pre class="prettyprint"><code class="language-java hljs "><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemsServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ItemsService</span> {</span>

    <span class="hljs-annotation">@Autowired</span>
    <span class="hljs-keyword">private</span> ItemsMapperCustom itemsMapperCustom;

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> List&lt;ItemsCustom&gt; <span class="hljs-title">findItemsList</span>(ItemsQueryVo itemsQueryVo)
            <span class="hljs-keyword">throws</span> Exception {

        <span class="hljs-comment">//通过itemsMapperCustom查询数据库</span>
        <span class="hljs-keyword">return</span> itemsMapperCustom.findItemsList(itemsQueryVo);
    }

}</code></pre> 
 <p>　　<font size="3">可以看出，实现类中是通过@Autowired注入itemsMapperCustom，这个itemsMapperCustom是上面那个插曲中定义的一个mapper。它会通过spring配的扫描器扫描到，并将对象装到spring容器中，然后在这注入进来，然后调用findItemsList方法来操作数据库。至于itemQueyVo，实际中，是将前台传来的数据封装进来，然后传进来的。这样就打通了service与dao之间的通道了。</font></p> 
 <h3 id="33-配置applicationcontext-servicexml"><strong><font size="４">3.3 配置applicationContext-service.xml</font></strong></h3> 
 <p>　　<font size="3">这里是第二个spring的配置文件了，还是在config/spring文件夹下面，主要是用来配置所有的service的，如下：</font></p> 
 <pre class="prettyprint"><code class="language-xml hljs "><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">beans</span> <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">"http://www.springframework.org/schema/beans"</span> <span class="hljs-attribute">xmlns:xsi</span>=<span class="hljs-value">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="hljs-attribute">xmlns:mvc</span>=<span class="hljs-value">"http://www.springframework.org/schema/mvc"</span> <span class="hljs-attribute">xmlns:context</span>=<span class="hljs-value">"http://www.springframework.org/schema/context"</span> <span class="hljs-attribute">xmlns:aop</span>=<span class="hljs-value">"http://www.springframework.org/schema/aop"</span> <span class="hljs-attribute">xmlns:tx</span>=<span class="hljs-value">"http://www.springframework.org/schema/tx"</span> <span class="hljs-attribute">xsi:schemaLocation</span>=<span class="hljs-value">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd"</span>&gt;</span>

   <span class="hljs-comment">&lt;!-- 商品管理的service --&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">bean</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"itemsService"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"ssm.service.impl.ItemsServiceImpl"</span>/&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">beans</span>&gt;</span></code></pre> 
 <p>　　<font size="3">当然咯，如果使用注解的话，这里就不用配了，先用xml的方式吧。</font></p> 
 <h3 id="34-配置applicationcontext-transactionxml"><strong><font size="４">3.4 配置applicationContext-transaction.xml</font></strong></h3> 
 <p>　　<font size="3">这里是第三个spring的配置文件了，还是在config/spring文件夹下面，主要是用来配置spring事务管理的，如下：</font></p> 
 <pre class="prettyprint"><code class="language-xml hljs "><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">beans</span> <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">"http://www.springframework.org/schema/beans"</span> <span class="hljs-attribute">xmlns:xsi</span>=<span class="hljs-value">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="hljs-attribute">xmlns:mvc</span>=<span class="hljs-value">"http://www.springframework.org/schema/mvc"</span> <span class="hljs-attribute">xmlns:context</span>=<span class="hljs-value">"http://www.springframework.org/schema/context"</span> <span class="hljs-attribute">xmlns:aop</span>=<span class="hljs-value">"http://www.springframework.org/schema/aop"</span> <span class="hljs-attribute">xmlns:tx</span>=<span class="hljs-value">"http://www.springframework.org/schema/tx"</span> <span class="hljs-attribute">xsi:schemaLocation</span>=<span class="hljs-value">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd"</span>&gt;</span>

   <span class="hljs-comment">&lt;!-- 事务管理器 --&gt;</span>
   <span class="hljs-comment">&lt;!-- 对mybatis操作数据事务控制，spring使用jdbc的事务控制类 --&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">bean</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"transactionManager"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- 数据源dataSource在applicationContex-dao.xml中配置了 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"dataSource"</span> <span class="hljs-attribute">ref</span>=<span class="hljs-value">"dataSource"</span>/&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">bean</span>&gt;</span>

   <span class="hljs-comment">&lt;!-- 通知 --&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">tx:advice</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"txAdvice"</span> <span class="hljs-attribute">transaction-manager</span>=<span class="hljs-value">"transactionManager"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">tx:attributes</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">tx:method</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"save*"</span> <span class="hljs-attribute">propagation</span>=<span class="hljs-value">"REQUIRED"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">tx:method</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"delete*"</span> <span class="hljs-attribute">propagation</span>=<span class="hljs-value">"REQUIRED"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">tx:method</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"update*"</span> <span class="hljs-attribute">propagation</span>=<span class="hljs-value">"REQUIRED"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">tx:method</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"insert*"</span> <span class="hljs-attribute">propagation</span>=<span class="hljs-value">"REQUIRED"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">tx:method</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"find*"</span> <span class="hljs-attribute">propagation</span>=<span class="hljs-value">"SUPPORTS"</span> <span class="hljs-attribute">read-only</span>=<span class="hljs-value">"true"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">tx:method</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"get*"</span> <span class="hljs-attribute">propagation</span>=<span class="hljs-value">"SUPPORTS"</span> <span class="hljs-attribute">read-only</span>=<span class="hljs-value">"true"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">tx:method</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"select*"</span> <span class="hljs-attribute">propagation</span>=<span class="hljs-value">"SUPPORTS"</span> <span class="hljs-attribute">read-only</span>=<span class="hljs-value">"true"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">tx:attributes</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">tx:advice</span>&gt;</span>

   <span class="hljs-tag">&lt;<span class="hljs-title">aop:config</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">aop:advisor</span> <span class="hljs-attribute">advice-ref</span>=<span class="hljs-value">"txAdvice"</span> <span class="hljs-attribute">pointcut</span>=<span class="hljs-value">"execution(* ssm.service.impl.*.*(..))"</span>/&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">aop:config</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">beans</span>&gt;</span></code></pre> 
 <p>　　<font size="3">这样service层就整合完了。接下来就是整合springmvc了。</font></p> 
 <h2 id="4-整合springmvc"><strong>4. 整合springmvc</strong></h2> 
 <p>　　<font size="3">上面提到过，springmvc是spring的一个模块，所以不需要整合，我们只需要加入springmvc所需的包即可，将springmvc文件夹下的jar包导入到lib中即可。关于springmvc的使用，在前面几篇文章都写了，这里为了完整性，也总结一下。</font></p> 
 <h3 id="41-配置前端控制器"><strong><font size="４">4.1 配置前端控制器</font></strong></h3> 
 <p>　　<font size="3">前端控制器要配置在WEB-INF/web.xml中，如下：</font></p> 
 <pre class="prettyprint"><code class="language-xml hljs "><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">web-app</span> <span class="hljs-attribute">xmlns:xsi</span>=<span class="hljs-value">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">"http://java.sun.com/xml/ns/javaee"</span> <span class="hljs-attribute">xsi:schemaLocation</span>=<span class="hljs-value">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"WebApp_ID"</span> <span class="hljs-attribute">version</span>=<span class="hljs-value">"3.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">display-name</span>&gt;</span>SpringMVC_Study<span class="hljs-tag">&lt;/<span class="hljs-title">display-name</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">welcome-file-list</span>&gt;</span> 
    <span class="hljs-tag">&lt;<span class="hljs-title">welcome-file</span>&gt;</span>index.jsp<span class="hljs-tag">&lt;/<span class="hljs-title">welcome-file</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">welcome-file-list</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- 配置前端控制器DispatcherServlet --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">servlet</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">servlet-name</span>&gt;</span>springmvc<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-class</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">init-param</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-title">param-name</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">param-value</span>&gt;</span>classpath:springmvc.xml<span class="hljs-tag">&lt;/<span class="hljs-title">param-value</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">init-param</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">servlet</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">servlet-mapping</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">servlet-name</span>&gt;</span>springmvc<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">url-pattern</span>&gt;</span>*.action<span class="hljs-tag">&lt;/<span class="hljs-title">url-pattern</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">servlet-mapping</span>&gt;</span>  
<span class="hljs-tag">&lt;/<span class="hljs-title">web-app</span>&gt;</span></code></pre> 
 <h3 id="42-配置处理器映射器处理器适配器和视图解析器"><strong><font size="４">4.2 配置处理器映射器、处理器适配器和视图解析器</font></strong></h3> 
 <p>　　<font size="3">这里使用注解的方式配置，因为注解的方式比较简单。配置在springmvc.xml中</font></p> 
 <pre class="prettyprint"><code class="language-xml hljs "><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">beans</span> <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">"http://www.springframework.org/schema/beans"</span> <span class="hljs-attribute">xmlns:xsi</span>=<span class="hljs-value">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="hljs-attribute">xmlns:mvc</span>=<span class="hljs-value">"http://www.springframework.org/schema/mvc"</span> <span class="hljs-attribute">xmlns:context</span>=<span class="hljs-value">"http://www.springframework.org/schema/context"</span> <span class="hljs-attribute">xmlns:aop</span>=<span class="hljs-value">"http://www.springframework.org/schema/aop"</span> <span class="hljs-attribute">xmlns:tx</span>=<span class="hljs-value">"http://www.springframework.org/schema/tx"</span> <span class="hljs-attribute">xsi:schemaLocation</span>=<span class="hljs-value">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd"</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 一个配置节解决映射器和适配器的配置注解配置 --&gt;</span> 
    <span class="hljs-tag">&lt;<span class="hljs-title">mvc:annotation-driven</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">mvc:annotation-driven</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 扫描所有的Controller --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">context:component-scan</span> <span class="hljs-attribute">base-package</span>=<span class="hljs-value">"ssm.controller"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">context:component-scan</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 配置视图解析器 进行jsp解析，默认使用jstl标签，classpath下得有jstl的包 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">bean</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">beans</span>&gt;</span></code></pre> 
 <h3 id="43-编写controller即handler"><strong><font size="４">4.3 编写Controller（即Handler）</font></strong></h3> 
 <p>　　<font size="3">接下来写一个Controller，如下：</font></p> 
 <pre class="prettyprint"><code class="language-java hljs "><span class="hljs-annotation">@Controller</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemsController</span> {</span>

    <span class="hljs-annotation">@Autowired</span>
    <span class="hljs-keyword">private</span> ItemsService itemsService;

    <span class="hljs-annotation">@RequestMapping</span>(<span class="hljs-string">"/queryItems"</span>)
    <span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">queryItems</span>() <span class="hljs-keyword">throws</span> Exception {

        <span class="hljs-comment">//调用service查找数据库，查询商品列表</span>
        <span class="hljs-comment">//这里传入进去一个null表示没有附加条件，查询所有的。因为service中接收的是一个ItemsQueryVo对象</span>
        List&lt;ItemsCustom&gt; itemsList = itemsService.findItemsList(<span class="hljs-keyword">null</span>);

        <span class="hljs-comment">//返回ModelAndView</span>
        ModelAndView modelAndView = <span class="hljs-keyword">new</span> ModelAndView();
        modelAndView.addObject(<span class="hljs-string">"itemsList"</span>, itemsList);
        modelAndView.setViewName(<span class="hljs-string">"/WEB-INF/jsp/items/itemsList.jsp"</span>);

        <span class="hljs-keyword">return</span> modelAndView;
    }
}</code></pre> 
 <p>　　<font size="3">前台jsp页面还是第二篇博文中写的那个，没有变，就不写了。最后还有个重要的步骤就是加载spring容器。</font></p> 
 <h3 id="44-加载spring容器"><strong><font size="４">4.4 加载spring容器</font></strong></h3> 
 <p>　　<font size="3">在web.xml中添加spring容器监听器，加载spring容器：</font></p> 
 <pre class="prettyprint"><code class="language-xml hljs "><span class="hljs-comment">&lt;!-- 加载spring容器 --&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">context-param</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-title">param-name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">param-value</span>&gt;</span>classpath:spring/applicationContext-*.xml<span class="hljs-tag">&lt;/<span class="hljs-title">param-value</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-title">context-param</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">listener</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="hljs-tag">&lt;/<span class="hljs-title">listener-class</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-title">listener</span>&gt;</span></code></pre> 
 <p>　　<font size="3">到此为止，spring、mybatis和springmvc就整合完了，开启tomcat，然后在浏览器中输入<a href="http://localhost:8080/SpringMVC_Study/queryItems.action">http://localhost:8080/SpringMVC_Study/queryItems.action</a>即可查询出Items表中的信息，说明整合完成。  　　</font></p> 
 <p>　　相关阅读：<a href="http://blog.csdn.net/column/details/spring-mvc.html">http://blog.csdn.net/column/details/spring-mvc.html</a>  　　学习笔记源码下载地址：<a href="https://github.com/eson15/SpringMVC_Study">https://github.com/eson15/SpringMVC_Study</a></p> 
 <hr> 
 <p>—–乐于分享，共同进步！  —–我的博客主页：<a href="http://blog.csdn.net/eson_15">http://blog.csdn.net/eson_15</a></p>
</div>